"""
–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥–∏—Å—Ç–æ—Ä—Å–∏–∏ –≤ new_detect.py
"""
from pathlib import Path

print("="*60)
print("–ü–†–û–í–ï–†–ö–ê –ò–ù–¢–ï–ì–†–ê–¶–ò–ò –£–°–¢–†–ê–ù–ï–ù–ò–Ø –î–ò–°–¢–û–†–°–ò–ò –í NEW_DETECT.PY")
print("="*60)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ–∞–π–ª–∞
print("\n1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞ new_detect.py...")
file_path = Path("new_detect.py")
if file_path.exists():
    print(f"   ‚úì –§–∞–π–ª –Ω–∞–π–¥–µ–Ω: {file_path.absolute()}")
else:
    print(f"   ‚úó –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω!")
    exit(1)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
print("\n2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ undistort_image...")
with open(file_path, 'r', encoding='utf-8') as f:
    content = f.read()
    
if 'def undistort_image' in content:
    print("   ‚úì –§—É–Ω–∫—Ü–∏—è undistort_image –Ω–∞–π–¥–µ–Ω–∞")
else:
    print("   ‚úó –§—É–Ω–∫—Ü–∏—è undistort_image –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
    exit(1)

if 'CV2_AVAILABLE' in content:
    print("   ‚úì –ü—Ä–æ–≤–µ—Ä–∫–∞ CV2_AVAILABLE –Ω–∞–π–¥–µ–Ω–∞")
else:
    print("   ‚úó –ü—Ä–æ–≤–µ—Ä–∫–∞ CV2_AVAILABLE –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
    exit(1)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ main
print("\n3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ main()...")
if '–≠–¢–ê–ü 1: –£–°–¢–†–ê–ù–ï–ù–ò–ï –î–ò–°–¢–û–†–°–ò–ò' in content:
    print("   ‚úì –≠—Ç–∞–ø —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥–∏—Å—Ç–æ—Ä—Å–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ main()")
else:
    print("   ‚úó –≠—Ç–∞–ø —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥–∏—Å—Ç–æ—Ä—Å–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ main()")
    exit(1)

if 'reference_array = undistort_image(reference_array)' in content:
    print("   ‚úì –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏—Å—Ç–æ—Ä—Å–∏–∏ –¥–ª—è —ç—Ç–∞–ª–æ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è")
else:
    print("   ‚úó –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏—Å—Ç–æ—Ä—Å–∏–∏ –¥–ª—è —ç—Ç–∞–ª–æ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")

if 'test_array = undistort_image(test_array)' in content:
    print("   ‚úì –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏—Å—Ç–æ—Ä—Å–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è")
else:
    print("   ‚úó –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏—Å—Ç–æ—Ä—Å–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ OpenCV
print("\n4Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ OpenCV...")
try:
    import cv2
    print(f"   ‚úì OpenCV —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –≤–µ—Ä—Å–∏—è: {cv2.__version__}")
    opencv_available = True
except ImportError:
    print("   ‚ö†Ô∏è  OpenCV –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
    print("   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: pip install opencv-python")
    opencv_available = False

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
print("\n5Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏...")
calib_file = Path("camera_calibration.pkl")
if calib_file.exists():
    print(f"   ‚úì –§–∞–π–ª –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –Ω–∞–π–¥–µ–Ω: {calib_file.absolute()}")
    calib_available = True
else:
    print(f"   ‚ö†Ô∏è  –§–∞–π–ª –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω: {calib_file.absolute()}")
    print("   –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª: python3 create_calibration.py")
    calib_available = False

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
print("\n6Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π...")
test_images = ['chess.jpg', 'chessboard_3_3.jpg']
images_found = 0
for img in test_images:
    img_path = Path(img)
    if img_path.exists():
        print(f"   ‚úì {img} –Ω–∞–π–¥–µ–Ω")
        images_found += 1
    else:
        print(f"   ‚ö†Ô∏è  {img} –Ω–µ –Ω–∞–π–¥–µ–Ω")

# –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å
print("\n" + "="*60)
print("–ò–¢–û–ì–û–í–´–ô –°–¢–ê–¢–£–°")
print("="*60)

print("\n‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!")
print("   ‚Ä¢ –§—É–Ω–∫—Ü–∏—è undistort_image –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ new_detect.py")
print("   ‚Ä¢ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏—Å—Ç–æ—Ä—Å–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫ –ø–µ—Ä–≤—ã–π —ç—Ç–∞–ø –≤ main()")
print("   ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ OpenCV –∏ —Ñ–∞–π–ª–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞")

if opencv_available and calib_available:
    print("\n‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏—Å—Ç–æ—Ä—Å–∏–∏ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å!")
    print("   ‚Ä¢ OpenCV —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
    print("   ‚Ä¢ –§–∞–π–ª –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –Ω–∞–π–¥–µ–Ω")
elif opencv_available and not calib_available:
    print("\n‚ö†Ô∏è  –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏—Å—Ç–æ—Ä—Å–∏–∏ –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–æ")
    print("   ‚Ä¢ OpenCV —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚úì")
    print("   ‚Ä¢ –§–∞–π–ª –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚úó")
    print("\nüí° –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏:")
    print("   python3 create_calibration.py")
elif not opencv_available and calib_available:
    print("\n‚ö†Ô∏è  –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏—Å—Ç–æ—Ä—Å–∏–∏ –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–æ")
    print("   ‚Ä¢ OpenCV –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚úó")
    print("   ‚Ä¢ –§–∞–π–ª –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –Ω–∞–π–¥–µ–Ω ‚úì")
    print("\nüí° –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ OpenCV:")
    print("   pip install opencv-python")
else:
    print("\n‚ö†Ô∏è  –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏—Å—Ç–æ—Ä—Å–∏–∏ –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–æ")
    print("   ‚Ä¢ OpenCV –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚úó")
    print("   ‚Ä¢ –§–∞–π–ª –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω ‚úó")
    print("\nüí° –î–ª—è —Ä–∞–±–æ—Ç—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥–∏—Å—Ç–æ—Ä—Å–∏–∏:")
    print("   1. pip install opencv-python")
    print("   2. python3 create_calibration.py")

print("\nüöÄ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ!")
print("   –ï—Å–ª–∏ OpenCV –∏–ª–∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç, –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–æ")
print("   –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç—É –±–µ–∑ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥–∏—Å—Ç–æ—Ä—Å–∏–∏.")

if images_found == 2:
    print(f"\n‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω—ã ({images_found}/2)")
    print("\nüéØ –ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É!")
    print("   python3 new_detect.py")
else:
    print(f"\n‚ö†Ô∏è  –ù–µ –≤—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞–π–¥–µ–Ω—ã ({images_found}/2)")
    print("   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ chess.jpg –∏ chessboard_3_3.jpg –µ—Å—Ç—å –≤ –ø–∞–ø–∫–µ")

print("\n" + "="*60)

